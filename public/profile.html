<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Panel | PixelTech Elite Store</title>
    <link rel="stylesheet" href="../css/styles.css">
    <script src="https://kit.fontawesome.com/0d623ded97.js" crossorigin="anonymous"></script>
    <style>
        .page-section {
            display: none;
        }

        .page-section.active {
            display: block;
        }

        .nav-link.active {
            background-color: #00AEC7;
            color: #111827;
            box-shadow: 0 10px 15px -3px rgba(0, 174, 199, 0.2);
        }

        /* ESTRUCTURA DASHBOARD: Altura fija para Sidebar y pegajosa */
        .dashboard-container {
            display: flex;
            align-items: flex-start; /* Permite que el aside se ancle arriba */
            background-color: #f8fafc;
            width: 100%;
            position: relative;
        }

        /* SIDEBAR: Siempre ocupa el alto de la pantalla menos el header */
        aside {
            position: sticky;
            top: 80px; /* Ajusta este valor al alto real de tu header */
            height: calc(100vh - 80px); /* Alto exacto solicitado */
            flex-shrink: 0;
            z-index: 40;
            background-color: #111827; /* brand-black */
        }

        /* CONTENIDO PRINCIPAL: Crece según la información */
        main {
            flex-grow: 1;
            min-height: calc(100vh - 80px);
        }

        /* SCROLL INTERNO: Evita que el historial de órdenes sea infinito */
        #orders-container {
            max-height: 70vh;
            overflow-y: auto;
            padding-right: 15px;
        }

        .profile-input-group {
            background-color: #f9fafb;
            border-radius: 1.25rem;
            padding: 0.75rem 1.5rem;
            transition: all 0.3s ease;
            border: 1px solid #f3f4f6;
        }

        .profile-input-group:focus-within {
            background-color: #ffffff;
            border-color: #00AEC7;
            box-shadow: 0 4px 12px rgba(0, 174, 199, 0.1);
        }

        .profile-input-group label {
            display: block;
            font-size: 8px;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: #9ca3af;
            margin-bottom: 0.15rem;
        }

        .profile-input-group input {
            width: 100%;
            background: transparent;
            border: none;
            outline: none;
            font-weight: 700;
            font-size: 0.875rem;
            color: #111827;
        }

        .modal-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(17, 24, 39, 0.8);
            backdrop-filter: blur(8px);
            z-index: 999;
            align-items: center;
            justify-content: center;
            padding: 1.5rem;
        }

        .modal-overlay.active {
            display: flex;
        }

        .custom-scroll::-webkit-scrollbar {
            width: 6px;
        }

        .custom-scroll::-webkit-scrollbar-thumb {
            background: #e5e7eb;
            border-radius: 10px;
        }
    </style>
</head>

<body class="bg-slate-50 font-sans text-brand-black">

    <div id="global-header"></div>

    <div class="dashboard-container">
        
        <aside class="w-20 md:w-80 text-white flex flex-col border-r border-white/5 shadow-2xl">
            <div class="p-8 hidden md:block">
                <div class="bg-slate-900/50 p-6 rounded-[2.5rem] border border-white/5 text-center">
                    <div id="user-avatar"
                        class="w-16 h-16 bg-brand-cyan text-brand-black rounded-2xl flex items-center justify-center font-black text-2xl shadow-lg mx-auto mb-4">
                        --
                    </div>
                    <p id="user-name-side" class="font-black text-sm truncate uppercase tracking-tighter">Cargando...</p>
                    <p id="user-email-side" class="text-[10px] text-gray-500 font-bold truncate">...</p>
                </div>
            </div>

            <nav class="flex-grow p-4 flex flex-col gap-3">
                <button class="nav-link active w-full flex items-center gap-4 px-5 py-4 rounded-2xl transition-all font-bold text-sm" data-target="section-orders">
                    <i class="fa-solid fa-box-open w-5 text-center"></i>
                    <span class="hidden md:block">Mis Compras</span>
                </button>
                <button class="nav-link w-full flex items-center gap-4 px-5 py-4 rounded-2xl transition-all font-bold text-sm text-gray-400 hover:bg-white/5" data-target="section-data">
                    <i class="fa-solid fa-user-shield w-5 text-center"></i>
                    <span class="hidden md:block">Datos de Cuenta</span>
                </button>
                <button class="nav-link w-full flex items-center gap-4 px-5 py-4 rounded-2xl transition-all font-bold text-sm text-gray-400 hover:bg-white/5" data-target="section-addresses">
                    <i class="fa-solid fa-location-dot w-5 text-center"></i>
                    <span class="hidden md:block">Mis Ubicaciones</span>
                </button>

                <div class="mt-auto pt-6 border-t border-white/5">
                    <button id="btn-logout-profile"
                        class="w-full flex items-center justify-center md:justify-start gap-4 px-4 py-3 rounded-xl text-gray-400 hover:text-brand-red transition duration-300">
                        <i class="fa-solid fa-power-off"></i>
                        <span class="hidden md:block font-black uppercase text-[10px] tracking-widest">Cerrar Sesión</span>
                    </button>
                </div>
            </nav>
        </aside>

        <main class="flex-grow p-6 md:p-12 bg-slate-50">
            <section id="section-orders" class="page-section active">
                <div class="mb-10">
                    <h1 class="text-4xl font-black tracking-tighter uppercase text-brand-black">Historial de <span class="text-gray-300">ordenes</span></h1>
                    <p class="text-xs font-bold text-gray-400 uppercase tracking-widest">Consulta tus pedidos y garantías activas.</p>
                </div>
                <div id="orders-container" class="space-y-6 custom-scroll"></div>
            </section>

            <section id="section-data" class="page-section">
                <div class="mb-10">
                    <h1 class="text-4xl font-black tracking-tighter uppercase text-brand-black">Datos de <span class="text-gray-300">Cuenta</span></h1>
                    <p class="text-xs font-bold text-gray-400 uppercase tracking-widest">Actualiza tu identidad de usuario.</p>
                </div>
                <div class="bg-white rounded-[2.5rem] p-10 border border-gray-100 shadow-sm max-w-2xl">
                    <form id="profile-form" class="space-y-6">
                        <div class="profile-input-group">
                            <label>Nombre Completo</label>
                            <input type="text" id="form-name" required>
                        </div>
                        <div class="profile-input-group">
                            <label>Documento de Identidad</label>
                            <input type="text" id="form-id">
                        </div>
                        <div class="profile-input-group">
                            <label>WhatsApp Móvil</label>
                            <input type="text" id="form-phone">
                        </div>
                        <div class="profile-input-group">
                            <label>Fecha de Nacimiento</label>
                            <input type="date" id="form-birth">
                        </div>
                        <button type="submit" class="bg-brand-black text-white px-12 py-5 rounded-2xl font-black text-[10px] uppercase tracking-widest hover:bg-brand-cyan hover:text-brand-black transition-all shadow-xl">Actualizar Perfil</button>
                    </form>
                </div>
            </section>

            <section id="section-addresses" class="page-section">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-10 gap-4">
                    <div>
                        <h1 class="text-4xl font-black tracking-tighter uppercase text-brand-black">Mis <span class="text-gray-300">Ubicaciones</span></h1>
                        <p class="text-xs font-bold text-gray-400 uppercase tracking-widest">Gestiona tus puntos de despacho.</p>
                    </div>
                    <button id="btn-open-address-modal" class="bg-brand-black text-white px-8 py-4 rounded-2xl font-black text-[9px] uppercase tracking-widest shadow-lg hover:bg-brand-cyan hover:text-brand-black transition-all">
                        <i class="fa-solid fa-plus mr-2"></i> Añadir Nueva
                    </button>
                </div>
                <div id="addresses-list" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"></div>
            </section>
        </main>
    </div>

    <div id="global-footer"></div>

    <div id="address-modal" class="modal-overlay">
        <div class="bg-white w-full max-w-lg rounded-[2.5rem] p-10 shadow-2xl animate-in zoom-in-95 duration-300">
            <div class="flex justify-between items-center mb-8">
                <h3 class="text-2xl font-black tracking-tighter uppercase">Nueva <span class="text-gray-300">Ubicación</span></h3>
                <button id="btn-close-modal" class="text-gray-400 hover:text-brand-red transition"><i class="fa-solid fa-xmark text-xl"></i></button>
            </div>

            <form id="address-form" class="space-y-6">
                <div class="profile-input-group">
                    <label>Nombre / Alias (Ej: Casa, Oficina)</label>
                    <input type="text" id="modal-addr-alias" required placeholder="Mi Apartamento">
                </div>
                <div class="profile-input-group">
                    <label>Dirección Exacta</label>
                    <input type="text" id="modal-addr-value" required placeholder="Calle 100 # 15 - 20">
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="relative">
                        <div class="profile-input-group">
                            <label>Departamento</label>
                            <input type="text" id="modal-dept-search" placeholder="Escribe para buscar..." autocomplete="off" required>
                            <input type="hidden" id="modal-addr-dept-id">
                        </div>
                        <div id="dept-results" class="absolute z-50 w-full mt-2 bg-white border border-gray-100 rounded-2xl shadow-xl hidden max-h-48 overflow-y-auto p-2 custom-scroll"></div>
                    </div>
                    <div class="relative">
                        <div class="profile-input-group opacity-50" id="city-input-container">
                            <label>Ciudad / Municipio</label>
                            <input type="text" id="modal-city-search" placeholder="Selecciona Depto primero" autocomplete="off" required disabled>
                        </div>
                        <div id="city-results" class="absolute z-50 w-full mt-2 bg-white border border-gray-100 rounded-2xl shadow-xl hidden max-h-48 overflow-y-auto p-2 custom-scroll"></div>
                    </div>
                </div>

                <div class="flex gap-4 pt-4">
                    <button type="button" id="btn-cancel-modal" class="flex-grow bg-slate-100 text-gray-400 py-5 rounded-2xl font-black text-[10px] uppercase tracking-widest hover:bg-slate-200 transition">Cancelar</button>
                    <button type="submit" class="flex-grow bg-brand-cyan text-brand-black py-5 rounded-2xl font-black text-[10px] uppercase tracking-widest hover:bg-brand-black hover:text-white transition shadow-lg">Guardar Dirección</button>
                </div>
            </form>
        </div>
    </div>

    <script type="module">
        import { loadGlobalHeader, loadGlobalFooter } from '../js/global-components.js';
        loadGlobalHeader();
        loadGlobalFooter();
    </script>
    <script type="module" src="../js/profile.js"></script>
</body>

</html>